<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Stock Market Predictor</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}" />
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <script src="{{ url_for('static', filename='scripts.js') }}"></script>
</head>
<body>
  <!-- Dark Mode Toggle -->
  <div class="top-bar">
    <button id="themeToggle">üåô Dark Mode</button>
  </div>

  <div class="container">
    <h1> Stock Market Predictor</h1>

    <form method="post" aria-label="Stock symbol input form" id="stockForm">
      <label for="stock-symbol">Enter Stock Symbol</label>
      <input type="text" id="stock-symbol" name="stock" value="{{ stock }}" autocomplete="off" aria-required="true" />

      <small>Or select from popular tickers below:</small>
      <select id="ticker_select" name="ticker_select">
        <option value="">-- Select Popular Ticker --</option>
        {% for ticker in popular_tickers %}
          <option value="{{ ticker.symbol }}" {% if stock == ticker.symbol %}selected{% endif %}>
            {{ ticker.symbol }} - {{ ticker.name }}
          </option>
        {% endfor %}
      </select>

      <input type="submit" value="üîÆ Predict" />
    </form>

    <!-- Loading spinner -->
    <div id="loading" class="loading">‚è≥ Fetching stock data, please wait...</div>

    {% if error_msg %}
      <div class="error-message">{{ error_msg }}</div>
    {% endif %}

    {% if data_html %}
      <h2>üìä Stock Data</h2>
      <div class="table-container">
        {{ data_html|safe }}
      </div>
    {% endif %}

    {% if graph_urls %}
      <h2 id="chartsSection">üìâ Charts & Analysis</h2>

      <section>
        <h3>
          Price vs 50-day Moving Average
          <span class="tooltip">?
            <span class="tooltiptext">This chart shows stock price vs 50-day moving average.</span>
          </span>
        </h3>
        {{ graph_urls['price_ma50'] | safe }}
      </section>

      <section>
        <h3>
          Price vs 50 & 100-day MAs
          <span class="tooltip">?
            <span class="tooltiptext">Stock price compared with 50 & 100-day averages.</span>
          </span>
        </h3>
        {{ graph_urls['price_ma50_ma100'] | safe }}
      </section>

      <section>
        <h3>
          Price vs 100 & 200-day MAs
          <span class="tooltip">?
            <span class="tooltiptext">Stock price compared with 100 & 200-day averages.</span>
          </span>
        </h3>
        {{ graph_urls['price_ma100_ma200'] | safe }}
      </section>

      <section>
        <h3>
          Predicted vs Original Price
          <span class="tooltip">?
            <span class="tooltiptext">Compares model predictions with actual stock prices.</span>
          </span>
        </h3>
        {{ graph_urls['predicted_vs_original'] | safe }}
      </section>
    {% endif %}
  </div>
</body>
</html>
